{"version":3,"sources":["assets/scripts/homeScene/storeBoard.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import GameDataStorage, { User, GameConfig } from \"../common/module/gameDataManager\";\nimport HomeScene from \"./homeScene\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class Store extends cc.Component {\n\n    //三个存档节点\n    @property({ type: cc.Node })\n    private storeNode: cc.Node[] = [];\n\n    @property({ type: cc.Node })\n    private inputBox: cc.Node = null;\n\n    @property({ type: cc.Label })\n    private inputLabel: cc.Label = null;\n\n    private gameConfig: GameConfig = null;\n    private users: User[] = null;\n\n    private clickStoreButton: boolean = false;\n    private homeScene: HomeScene = null;\n    onLoad() {\n        this.homeScene = cc.find(\"Canvas\").getComponent(\"homeScene\");\n    }\n\n    start() {\n        this.users = GameDataStorage.getUsers();\n        this.gameConfig = GameDataStorage.getGameConfig();\n        this.updateStoreBoard();\n    }\n\n    /**\n     * 更新存档面板\n     */\n    private updateStoreBoard() {\n        for (let i = 0; i < 3; i++) {\n            if (this.users[i] === undefined)\n                this.updateStore(this.storeNode[i], null);\n            else\n                this.updateStore(this.storeNode[i], this.users[i])\n        }\n    }\n\n    /**\n     * 更新存档节点\n     * @param storeNode 存档节点 \n     * @param user 用户数据，为null表示此存档为空\n     */\n    private updateStore(storeNode: cc.Node, user: User) {\n        let nameLabel: cc.Label = storeNode.getChildByName(\"nameLabel\").getComponent(cc.Label);\n        let startNum: cc.Label = storeNode.getChildByName(\"startNum\").getComponent(cc.Label);\n\n        if (user === null) {\n            nameLabel.string = \"无\";\n            startNum.string = `0/${this.gameConfig.getStarSum()}`;\n            return;\n        }\n\n        nameLabel.string = user.getUsername();\n        startNum.string = `${user.getStarSum()}/${this.gameConfig.getStarSum()}`;\n    }\n\n    /**\n     * 点击存档\n     * @param storeNum 存档几,1开始\n     */\n    storeButton(e, storeNum: string) {\n        if (this.clickStoreButton)\n            return;\n        this.clickStoreButton = true;\n        let i: number = parseInt(storeNum);\n        if (this.users.length < i) { //没有存档，弹出输入框新建\n            this.inputBox.active = true;\n            this.clickStoreButton = false;\n            return;\n        }\n        //有存档,跳转场景，将users下标传入\n        this.homeScene.selectLevelScene(i - 1);\n    }\n\n    /**\n     * 输入用户名确定\n     */\n    inputDetermine() {\n        this.inputBox.active = false;\n        if (this.inputLabel.string === \"\")\n            return;\n        GameDataStorage.createUser(this.inputLabel.string);\n        this.updateStoreBoard();\n    }\n\n    /**\n     * 输入用户名取消\n     */\n    cancelButton() {\n        this.inputBox.active = false;\n    }\n\n\n    /**\n     * 删除存档\n     * @param storeNum 存档几\n     */\n    deleteStore(e, storeNum: string) {\n        let i: number = parseInt(storeNum);\n        if (this.users.length < i)  //存档为空\n            return;\n        let name: string = this.users[i - 1].getUsername();\n        GameDataStorage.delUser(name);\n        this.updateStoreBoard();\n\n        console.log(\"删除存档\", name);\n    }\n\n\n\n}\n"]}