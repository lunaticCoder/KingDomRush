{"version":3,"sources":["assets/scripts/homeScene/homeScene.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import SoundsManager from \"../common/module/soundsManager\"\nimport StartAnim from \"./startAnim\";\nimport GameDataStorage from \"../common/module/gameDataManager\";\nimport { User } from \"../common/module/gameDataManager\"\nimport LevelDataManager from \"../common/module/levelDataManager\"\nimport LoadingDoorAnim from \"../../res/prefabs/loadingDoorAnim/loadingDoorAnim\";\nimport StorageManager from \"../common/module/storageManager\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass(\"ConfigFiles\")\nclass ConfigFiles {\n    @property({\n        type: cc.JsonAsset,\n        displayName: \"游戏配置\"\n    })\n    gameConfig: cc.JsonAsset = null;\n\n    @property({\n        type: cc.JsonAsset,\n        displayName: \"关卡配置\"\n    })\n    levelConfig: cc.JsonAsset = null;\n}\n\n@ccclass\nexport default class HomeScene extends cc.Component {\n\n    @property({\n        type: ConfigFiles,\n        displayName: \"游戏配置文件\"\n    })\n    private conFigFiles: ConfigFiles = new ConfigFiles();\n\n    @property({ type: LoadingDoorAnim })\n    private loadingDoorAnim: LoadingDoorAnim = null;\n\n    @property({ type: StartAnim })\n    private startAnim: StartAnim = null;\n\n    private isStartGame: boolean = false;\n    /**\n     * 是否点击了这个按钮\n     */\n    private isAboutButton: boolean = false;\n    /**\n     * 第一次进入游戏\n     */\n    fristEntry: boolean = true;\n    private clips: cc.AnimationClip[] = null;\n    onLoad() {\n        //初始化 模块\n        if (GameDataStorage.getGameConfig() === null) {\n            // cc.sys.localStorage.clear();\n            StorageManager.init();\n            SoundsManager.init();\n            GameDataStorage.init(this.conFigFiles.gameConfig.json);\n            LevelDataManager.initLevelData(this.conFigFiles.levelConfig.json);\n        }\n\n        this.clips = this.startAnim.node.getComponent(cc.Animation).getClips();\n    }\n\n    start() {\n        console.log(\"本地数据:\", cc.sys.localStorage);\n\n        SoundsManager.ins.curBGM = \"sounds/home_scene_bg\";\n        SoundsManager.ins.playBGM(\"sounds/home_scene_bg\");\n        if (this.fristEntry) {\n            this.startAnim.logoDown();\n            // this.fristEntry = false;\n        }\n\n    }\n\n    /**\n     * 点击 开始游戏 按钮\n     */\n    startGame() {\n        if (this.isStartGame) //保证播放开门动画期间，按开始游戏按钮 不重复开门\n            return;\n        this.isStartGame = true;\n        SoundsManager.ins.playEffect(\"sounds/click\");\n        this.startAnim.buttonUp();\n\n        let d: cc.ActionInterval = cc.delayTime(this.clips[1].duration);\n        let func: cc.ActionInstant = cc.callFunc(function () {\n            this.isStartGame = false;\n        }, this);\n        let seq: cc.ActionInterval = cc.sequence(d, func);\n        this.node.runAction(seq);\n    }\n\n    aboutButton() {\n        if (this.isAboutButton) //保证播放开门动画期间，按开始游戏按钮 不重复开门\n            return;\n        this.isAboutButton = true;\n\n        SoundsManager.ins.playEffect(\"sounds/click\");\n        let func: cc.ActionInstant = cc.callFunc(function () {\n            cc.director.loadScene(\"aboutScene\");\n        }, this);\n        this.loadingDoorAnim.closeDoor(func);\n\n        GameDataStorage.preserveGameData();\n    }\n\n    /**\n     * 跳转到 选关 场景\n     */\n    selectLevelScene(usersI: number) {\n        let users: User[] = GameDataStorage.getUsers();\n        GameDataStorage.setCurrentUser(users[usersI])\n        SoundsManager.ins.playEffect(\"sounds/click\");\n        let func: cc.ActionInstant = cc.callFunc(function () {\n            cc.director.loadScene(\"selectLevelScene\");\n        }, this);\n        this.loadingDoorAnim.closeDoor(func);\n\n        GameDataStorage.preserveGameData();\n    }\n}\n"]}