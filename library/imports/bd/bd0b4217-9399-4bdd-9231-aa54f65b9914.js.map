{"version":3,"sources":["assets/scripts/selecttLevelScene/selectLevelScene.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import GameDataStorage, { User, GameConfig } from \"../common/module/gameDataManager\";\nimport HomeScene from \"../homeScene/homeScene\";\nimport LevelManager from \"./levelManager\";\nimport LevelScene from \"../levelScene/levelScene\";\nimport LoadingDoorAnim from \"../../res/prefabs/loadingDoorAnim/loadingDoorAnim\";\nimport SoundsManager from \"../common/module/soundsManager\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class SelectLevelScene extends cc.Component {\n\n    @property({ type: LoadingDoorAnim })\n    private loadingDoorAnim: LoadingDoorAnim = null;\n\n    @property({ type: cc.Label })\n    private scoreLabel: cc.Label = null;\n\n    @property({ type: LevelManager })\n    private levelManager: LevelManager = null;\n\n    @property({ type: cc.Animation })\n    private skillsBoardAnimation: cc.Animation = null;\n\n\n    private user: User = null;\n    private isBackButton: boolean = false;\n    private gameConfig: GameConfig = null;\n    onLoad() {\n        this.gameConfig = GameDataStorage.getGameConfig();\n    }\n\n    start() {\n        this.user = GameDataStorage.getCurrentUser();\n        this.loadingDoorAnim.setState(false);\n        this.loadingDoorAnim.openDoor();\n        SoundsManager.ins.curBGM = \"sounds/selectLevelsceneBGM\";\n        SoundsManager.ins.playBGM(SoundsManager.ins.curBGM);\n\n        this.updateScoreLabel();\n        this.levelManager.updateLevelMap(this.user);\n    }\n\n    /**\n     * 更新成绩板 \n     */\n    updateScoreLabel() {\n        let max: number = this.gameConfig.getStarSum();\n        let num: number = this.user.getCurrentHaveStarNum();\n        this.scoreLabel.string = num.toString() + \"/\" + max.toString();\n    }\n\n    backButton() {\n        if (this.isBackButton) //保证播放开门动画期间，按开始游戏按钮 不重复开门\n            return;\n        this.isBackButton = true;\n\n        SoundsManager.ins.playEffect(\"sounds/click\");\n        let func: cc.ActionInstant = cc.callFunc(function () {\n            cc.director.loadScene(\"homeScene\", function () {\n                // let homeScene: HomeScene = cc.find(\"Canvas\").getComponent(\"homeScene\");\n                // homeScene.fristEntry = false;\n\n                let loadingDoorAnim: cc.Node = cc.find(\"Canvas/centerAnchor/loadingDoorAnim\");\n                let loadingDoorAnimScr: LoadingDoorAnim = loadingDoorAnim.getComponent(\"loadingDoorAnim\");\n                loadingDoorAnimScr.setState(false);\n                loadingDoorAnimScr.openDoor();\n            });\n        }, this);\n        this.loadingDoorAnim.closeDoor(func);\n        GameDataStorage.preserveGameData();\n    }\n\n    toLevelScene(level) {\n        let func: cc.ActionInstant = cc.callFunc(function () {\n            cc.director.loadScene(\"levelScene\", function () {\n                let loadingDoorAnim: cc.Node = cc.find(\"Canvas/loadingDoorAnim\");\n                let loadingDoorAnimScr: LoadingDoorAnim = loadingDoorAnim.getComponent(\"loadingDoorAnim\");\n                loadingDoorAnimScr.setState(false);\n\n                //传入关卡数\n                let levelScene: LevelScene = cc.find(\"Canvas\").getComponent(\"levelScene\");\n                levelScene.levelNum = Number(level);\n\n            });\n        }, this);\n        this.loadingDoorAnim.closeDoor(func);\n\n        GameDataStorage.preserveGameData();\n    }\n\n    upgradeButton() {\n        this.skillsBoardAnimation.play(\"skillsBoardDown\");\n    }\n\n    // update (dt) {}\n}\n"]}