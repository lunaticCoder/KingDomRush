{"version":3,"sources":["assets/scripts/levelScene/builder.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import LevelScene from \"./levelScene\";\nimport GameDataStorage, { GameConfig } from \"../common/module/gameDataManager\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class Builder extends cc.Component {\n\n    @property({\n        type: cc.Prefab,\n    })\n    private arrowTower: cc.Prefab = null;\n    @property({\n        type: cc.Prefab,\n    })\n    private barrackTower: cc.Prefab = null;\n    @property({\n        type: cc.Prefab,\n    })\n    private magiclanTower: cc.Prefab = null;\n    @property({\n        type: cc.Prefab,\n    })\n    private artilleryTower: cc.Prefab = null;\n\n    @property({\n        type: cc.Node,\n    })\n    private graphics: cc.Node = null;\n\n    /**\n     * 建筑塔面板\n     */\n    private buildFace: cc.Node = null;\n    /**\n     * 建造的塔\n     */\n    private tower = null;\n    /**\n     * 没建塔时显示4种建筑的建造按钮界面\n     */\n    private g1: cc.Node = null;\n    /**\n     * 建塔后显示的升级和卖出按钮界面\n     */\n    private g2: cc.Node = null;\n    private upgrade: cc.Button = null;\n    /**\n     * 空地（背景）节点\n     */\n    private land: cc.Node = null;\n    private towerMap: cc.Node = null;\n    private levelScene: LevelScene = null;\n\n    private priceOfArrow: cc.Label = null;\n    private priceOfBarrack: cc.Label = null;\n    private priceOfMagiclan: cc.Label = null;\n    private priceOfArtillery: cc.Label = null;\n    private priceOfUpgrade: cc.Label = null;\n    private priceOfSale: cc.Label = null;\n\n\n    /* 数据 */\n    /**\n     * buildFace面板弹出和隐藏的时间\n     */\n    private timeOfFaceAction: number = 0.1;\n    /**\n     * builder编号\n     */\n    private num: number;\n    private stationOfSoldier: cc.Vec2[][];\n    /**\n     * 各种塔的数据\n     * arrowTower,artillery,barrack,magiclan\n     */\n    private dataOfTower: any[] = [];\n    /**\n     * 卖塔金币回收率\n     */\n    private rateOfSale: number;\n\n    /* 控制 */\n    private playingOutBuildFace: boolean = false;\n    private playingHiddenBuildFace: boolean = false;\n    private g: cc.Graphics = null;\n\n    onLoad() {\n        this.buildFace = this.node.getChildByName(\"buildFace\");\n        this.g1 = this.buildFace.getChildByName(\"g1\");\n        this.g2 = this.buildFace.getChildByName(\"g2\");\n        this.upgrade = this.g2.getChildByName(\"upgrade\").getComponent(cc.Button);\n        this.land = this.node.getChildByName(\"land\");\n        this.towerMap = cc.find(\"Canvas/towerMap\");\n        this.levelScene = cc.find(\"Canvas\").getComponent(\"levelScene\");\n        this.stationOfSoldier = this.levelScene.levelData.stationOfSoldier;\n\n        let gc: GameConfig = GameDataStorage.getGameConfig();\n\n        this.dataOfTower.push(gc.getDataOfArrowTower());\n        this.dataOfTower.push(gc.getDataOfArtillery());\n        this.dataOfTower.push(gc.getDataOfBarrack());\n        this.dataOfTower.push(gc.getDataOfMagiclan());\n\n        this.priceOfArrow = this.g1.getChildByName(\"arrow\").getChildByName(\"price\").getComponent(cc.Label);\n        this.priceOfBarrack = this.g1.getChildByName(\"barrack\").getChildByName(\"price\").getComponent(cc.Label);\n        this.priceOfMagiclan = this.g1.getChildByName(\"magiclan\").getChildByName(\"price\").getComponent(cc.Label);\n        this.priceOfArtillery = this.g1.getChildByName(\"artillery\").getChildByName(\"price\").getComponent(cc.Label);\n        this.priceOfUpgrade = this.g2.getChildByName(\"upgrade\").getChildByName(\"price\").getComponent(cc.Label);\n        this.priceOfSale = this.g2.getChildByName(\"sale\").getChildByName(\"price\").getComponent(cc.Label);\n\n        this.rateOfSale = gc.getRateOfSale();\n    }\n\n    start() {\n\n    }\n\n    /**\n     * 实例化加入父节点后必须执行\n     * @param num builder编号\n     */\n    init(num: number) {\n        this.g = this.graphics.addComponent(cc.Graphics);\n        this.g.strokeColor = this.g.fillColor = new cc.Color(0, 100, 0, 50);\n\n        this.num = num;\n    }\n\n    /**\n     * 弹出buildFace\n     */\n    outBuildFace() {\n        if (this.playingOutBuildFace)\n            return;\n        this.playingOutBuildFace = true;\n\n        this.node.zIndex = 10;\n\n        this.buildFace.active = true;\n        if (this.tower === null) {\n            this.refreshPriceOfBuild();\n            this.g1.active = true;\n        }\n        else { //有塔\n            this.refreshPriceOfUpOrSele();\n            if (this.tower.level === this.tower.maxLevel) //满级了\n                this.upgrade.interactable = false;\n            else\n                this.upgrade.interactable = true;\n            this.g2.active = true;\n        }\n\n        let a: cc.ActionInterval = cc.scaleTo(this.timeOfFaceAction, 1).easing(cc.easeBackOut());\n        let func: cc.ActionInstant = cc.callFunc(function () { this.playingOutBuildFace = false; }, this);\n        let seq: cc.ActionInterval = cc.sequence(a, func);\n        this.buildFace.runAction(seq);\n\n    }\n\n    /**\n     * 刷新各塔的建造价格\n     */\n    private refreshPriceOfBuild() {\n        this.setLabelInCase(this.priceOfArrow, this.dataOfTower[0][0].price);\n        this.setLabelInCase(this.priceOfArtillery, this.dataOfTower[1][0].price);\n        this.setLabelInCase(this.priceOfBarrack, this.dataOfTower[2][0].price);\n        this.setLabelInCase(this.priceOfMagiclan, this.dataOfTower[3][0].price);\n    }\n    /**\n     * 刷新升级塔和卖塔的价格\n     */\n    private refreshPriceOfUpOrSele() {\n        if (this.tower === null) {\n            cc.error(\"[ERROR] 升级或卖塔时，发现塔为null。请处理！\");\n            return;\n        }\n\n        let d: any = this.tower.getDataOfTower();\n\n        //升级按钮\n        if (this.tower.level < d.length)\n            this.setLabelInCase(this.priceOfUpgrade, d[this.tower.level].price);\n\n        //出售按钮\n        let p: number = d[this.tower.level - 1].price;\n        this.priceOfSale.string = Math.floor(p * this.rateOfSale).toString();\n    }\n    /**\n     * 根据操作价格与已有金币设置label\n     * @param l Label\n     * @param p 建筑价格\n     */\n    private setLabelInCase(l: cc.Label, p: number) {\n        let havedCash: number = this.levelScene.cash;\n        l.string = p.toString();\n        if (p > havedCash)\n            l.node.color = cc.Color.RED;\n        else\n            l.node.color = cc.Color.WHITE;\n    }\n\n    /**\n     * 隐藏buildFace\n     */\n    hiddenBuildFace() {\n        if (this.playingHiddenBuildFace)\n            return;\n        this.playingHiddenBuildFace = true;\n\n        this.node.zIndex = 0;\n\n        let a: cc.ActionInterval = cc.scaleTo(this.timeOfFaceAction, 0);\n        this.buildFace.runAction(a);\n\n        this.scheduleOnce(function () {\n            this.buildFace.active = false;\n            this.g1.active = false;\n            this.g2.active = false;\n\n            this.playingHiddenBuildFace = false;\n        }.bind(this), this.timeOfFaceAction);\n    }\n\n    buildArrowTower() {\n        let cost: number = this.dataOfTower[0][0].price;\n        this.buildTower(this.arrowTower, \"arrowTower\", cost);\n    }\n\n    buildArtilleryTower() {\n        let cost: number = this.dataOfTower[1][0].price;\n        this.buildTower(this.artilleryTower, \"artilleryTower\", cost);\n    }\n\n    buildMagiclanTower() {\n        let cost: number = this.dataOfTower[3][0].price;\n        this.buildTower(this.magiclanTower, \"magiclanTower\", cost);\n    }\n\n    buildBarrackTower() {\n        let cost: number = this.dataOfTower[2][0].price;\n        if (this.buildTower(this.barrackTower, \"barrack\", cost))\n            this.tower.stationOfSoldier = this.stationOfSoldier[this.num];\n    }\n\n    /**\n     * Builds tower\n     * @param towerPrefab \n     * @param component \n     * @param cost 花费金币\n     * @returns 金币不够，创建失败返回false\n     */\n    private buildTower(towerPrefab: cc.Prefab, component: string, cost: number): boolean {\n        if (!this.levelScene.subCash(cost))\n            return false;\n\n        this.tower = cc.instantiate(towerPrefab).getComponent(component);\n        this.towerMap.addChild(this.tower.node);\n        this.tower.node.setPosition(this.node.getPosition());\n\n        this.land.opacity = 0;\n        this.hiddenBuildFaceImmediately();\n        this.scheduleOnce(this.drawShootRange.bind(this), 0.5);\n        return true;\n    }\n\n    saleTower() {\n        this.levelScene.addCash(this.tower.price * this.rateOfSale);\n\n        this.deleteTower();\n        this.hiddenBuildFaceImmediately();\n        this.g.clear();\n    }\n\n    upTower() {\n        let havedCash: number = this.levelScene.cash;\n        let cost: number = this.tower.getPriceOfUpgrade();\n        if (havedCash < cost)\n            return;\n\n        this.levelScene.subCash(cost);\n        this.tower.upgrade();\n        this.drawShootRange();\n        if (this.tower.level === this.tower.maxLevel) {\n            this.upgrade.interactable = false;\n            return;\n        }\n\n        this.refreshPriceOfUpOrSele();\n    }\n\n    /**\n     * 立即隐藏BuildFace\n     */\n    hiddenBuildFaceImmediately() {\n        this.buildFace.scale = 0;\n        this.buildFace.active = false;\n        this.g1.active = false;\n        this.g2.active = false;\n    }\n\n    /**\n     * 删除塔并将空地显示出来\n     */\n    deleteTower() {\n        if (this.tower === null)\n            return;\n        this.tower.destroySelf();\n        this.g.clear();\n        this.tower = null;\n        this.land.opacity = 255;\n    }\n\n    /**\n    * 绘制射程范围\n    */\n    private drawShootRange() {\n        if (this.tower.shootRange === undefined)\n            return;\n\n        this.g.clear();\n        this.g.circle(0, 0, this.tower.shootRange);\n        this.g.stroke();\n        this.g.fill();\n    }\n\n    // update (dt) {}\n}\n"]}