{"version":3,"sources":["assets/scripts/levelScene/tower/magiclan/magiclanBullet.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAGM,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAG5C;IAA4C,kCAAY;IAAxD;QAAA,qEAiEC;QA9DW,iBAAW,GAAY,KAAK,CAAC;QAC7B,WAAK,GAAkB,IAAI,CAAC;;QA4DpC,iBAAiB;IACrB,CAAC;IA3DG,+BAAM,GAAN;QACI,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,eAAe,CAAC,CAAC;IAChE,CAAC;IAED,8BAAK,GAAL;IAEA,CAAC;IAED,6BAAI,GAAJ,UAAK,MAAc;QACf,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;IACzB,CAAC;IAED;;;;;OAKG;IACH,+BAAM,GAAN,UAAO,KAAc,EAAE,GAAY,EAAE,IAAY;QAC7C,IAAI,SAAS,GAAY,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,oBAAoB,CAAC,KAAK,CAAC,CAAC;QACtE,IAAI,OAAO,GAAY,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;QAClE,IAAI,GAAG,GAAY,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;QAC1C,IAAI,MAAM,GAAY,EAAE,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,GAAG,CAAC,EAAE,SAAS,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QAC9E,IAAI,CAAC,GAAY,EAAE,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC;QACjD,IAAI,KAAK,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC;YACjB,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;QAEd,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;QACjC,IAAI,IAAI,GAAsB,EAAE,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC,SAAS,EAAE,CAAC,EAAE,OAAO,CAAC,CAAC,CAAC;QAEzE,IAAI,KAAK,GAAqB,EAAE,CAAC,QAAQ,CAAC;YACtC,IAAI,CAAC,WAAW,EAAE,CAAC;QACvB,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAA;QAEb,IAAI,GAAG,GAAsB,EAAE,CAAC,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;QACtD,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;IAC7B,CAAC;IAEO,oCAAW,GAAnB;QACI,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACvC,CAAC;IAED,yCAAgB,GAAhB,UAAiB,KAAkB,EAAE,IAAiB;QAClD,IAAI,IAAI,CAAC,WAAW;YAChB,OAAO;QAEX,IAAI,IAAI,GAAY,KAAK,CAAC,IAAI,CAAC;QAC/B,IAAI,KAAK,GAAW,IAAI,CAAC,KAAK,CAAC;QAE/B,IAAI,KAAK,KAAK,OAAO,EAAE;YACnB,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC;YAC3B,IAAI,CAAC,GAAY,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC;YAC9C,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAEtB,IAAI,CAAC,WAAW,EAAE,CAAC;SACtB;IACL,CAAC;IA9DgB,cAAc;QADlC,OAAO;OACa,cAAc,CAiElC;IAAD,qBAAC;CAjED,AAiEC,CAjE2C,EAAE,CAAC,SAAS,GAiEvD;kBAjEoB,cAAc","file":"","sourceRoot":"/","sourcesContent":["import Monster from \"../../monster/monster\";\nimport MagiclanTower from \"./magiclanTower\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class MagiclanBullet extends cc.Component {\n\n    private attack: number;\n    private isFallFloor: boolean = false;\n    private tower: MagiclanTower = null;\n\n    onLoad() {\n        this.tower = this.node.parent.getComponent(\"magiclanTower\");\n    }\n\n    start() {\n\n    }\n\n    init(attack: number) {\n        this.attack = attack;\n    }\n\n    /**\n     * 移动，世界坐标\n     * @param start 起点\n     * @param end 终点\n     * @param time 移动时间\n     */\n    moveTo(start: cc.Vec2, end: cc.Vec2, time: number) {\n        let nodeStart: cc.Vec2 = this.node.parent.convertToNodeSpaceAR(start);\n        let nodeEnd: cc.Vec2 = this.node.parent.convertToNodeSpaceAR(end);\n        let sub: cc.Vec2 = nodeEnd.sub(nodeStart);\n        let middle: cc.Vec2 = cc.v2(nodeStart.x + sub.x / 2, nodeStart.y + sub.y / 2);\n        let c: cc.Vec2 = cc.v2(middle.x, nodeEnd.y + 60);\n        if (start.x === end.x)\n            c.x += 30;\n\n        this.node.setPosition(nodeStart);\n        let move: cc.ActionInterval = cc.bezierTo(time, [nodeStart, c, nodeEnd]);\n\n        let func1: cc.ActionInstant = cc.callFunc(function () {\n            this.destroySelf();\n        }.bind(this))\n\n        let seq: cc.ActionInterval = cc.sequence(move, func1);\n        this.node.runAction(seq);\n    }\n\n    private destroySelf() {\n        this.tower.releaseBullt(this.node);\n    }\n\n    onCollisionEnter(other: cc.Collider, self: cc.Collider) {\n        if (this.isFallFloor)\n            return;\n\n        let node: cc.Node = other.node;\n        let group: string = node.group;\n\n        if (group === \"Enemy\") {\n            this.node.stopAllActions();\n            let m: Monster = node.getComponent(\"monster\");\n            m.injure(this.attack);\n\n            this.destroySelf();\n        }\n    }\n\n    // update (dt) {}\n}\n"]}